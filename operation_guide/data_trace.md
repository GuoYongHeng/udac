# 数据追踪

在对UDB MySQL进行数据变更时，可能由于误操作导致需要进行数据检查以及数据回滚。数据追踪提供生成重建脚本功能，帮助进行数据检查，以及提供生成回滚脚本功能，帮助进行数据恢复。

## 注意事项

* 数据库版本为MySQL5.6及以上。
* 数据库已经开启Binlog，并且Binlog为Row模式。
* 选择时间内实例有Binlog。
* 选择的库表在当前库中存在，数据追踪需要获取元数据信息。
* 追踪类型只支持插入，删除，更新。

## 操作指南

### 新建任务

#### 注意事项

* 返回表数量限制10000条,用户可自填入表名称。
* 可选择的库只有一个，可选择的表只有20个。
* 追踪时间间隔为一个小时
* 数据追踪会拉取选定时间内的Binlog，然后进行解析，时间与表越精确解析查询速度越快。
* 数据追踪的结果只保留7天。

用户需要根据当前数据里面的库表数据选择目标库表，同时设置追踪时间与追踪类型。创建的数据追踪任务会进行排队处理
![image](/images/data_trace_create_task.png)

### 终止任务

已创建的任务在执行阶段，等待阶段，均可以进行终止

![image](/images/data_trace_list_stop.png)
![image](/images/data_trace_detail_stop.png)

### 任务详情

执行中的任务会展示步骤与进度, 当任务执行完成后，会显示解析结果详情, 结果详情可以展示具体的回滚语句以及变更前，变更后的值。

#### 注意事项

* 只支持10万条数据的跳页，多余10万后，列表页展示为单页滚动, 数据量过多，可以调整筛选条件，或者将数据下载进行查看

![image](/images/data_trace_detail.png)
![image](/images/data_trace_detail_entry.png)


### 任务列表

任务列表展示等待，执行中，失败，终止的任务，任务记录只保存7天。

![image](/images/data_trace_task_list.png)

### 导出

导出功能支持回滚语句的导出以及重建脚本的导出，回滚语句的导出最新时间在前，重建语句的导出最新时间在后
导出界面不可退出，退出后任务将进行取消，导出界面展示导出的进度，导出完成后，将立即进行下载。

1. 支持按照Binlog条目进行数据导出
2. 支持全部导出
3. 支持按照筛选条件进行导出

![image](/images/data_trace_download.png)
